# Valeurs de test pour Klask Chart
# Usage: helm install klask . -f custom-values.yaml

## Configuration de base
replicaCount: 1

global:
  security:
    allowInsecureImages: true

# ## Sécurité - Allégée pour le développement
# ## IMPORTANT: Renforcer en production !
# podSecurityContext:
#   fsGroup: 1000
#   # Temporairement désactivé pour dev
#   # runAsNonRoot: true
#   # runAsUser: 1000
#   # seccompProfile:
#   #   type: RuntimeDefault

# securityContext:
#   allowPrivilegeEscalation: false
#   # Temporairement désactivé pour permettre les écritures
#   readOnlyRootFilesystem: false
#   # runAsNonRoot: true
#   # runAsUser: 1000
#   capabilities:
#     drop:
#       - ALL

## Ingress - Activer pour tester l'accès externe
ingress:
  enabled: true
  className: "traefik"
  hosts:
    - host: klask.company.com
      paths:
        - path: /
          pathType: Prefix
  # Décommenter pour TLS:
  # tls:
  #   - secretName: klask-tls
  #     hosts:
  #       - klask.local

## Backend
backend:
  enabled: true
  image:
    repository: ghcr.io/klask-io/klask-backend
    tag: "pr-69"

  config:
    rustLog: "error,klask=info"
    logFormat: "text"  # Plus lisible en dev

## Frontend
frontend:
  enabled: true
  image:
    repository: ghcr.io/klask-io/klask-frontend
    tag: "pr-69"
  env:
    api:
      baseUrl: "https://klask.company.com"

## PostgreSQL - Credentials de test (NE PAS utiliser en production!)
postgresql:
  enabled: true
  image:
    repository: bitnamisecure/postgresql
    tag: latest
  auth:
    postgresPassword: "test-postgres"
    username: "klask"
    password: "test-klask"
    database: "klask"

  primary:
    persistence:
      enabled: true
      size: 2Gi  # Plus petit pour test

## Sécurité - Désactiver temporairement pour test si problème
# securityContext:
#   readOnlyRootFilesystem: false

## High Availability - Désactiver pour test local
podDisruptionBudget:
  enabled: false

## NetworkPolicy - Désactiver pour simplifier le test
networkPolicy:
  enabled: false

## Metrics - Activer si Prometheus est installé
metrics:
  enabled: false
  # serviceMonitor:
  #   enabled: true
